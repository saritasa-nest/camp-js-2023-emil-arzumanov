"use strict";(self.webpackChunkangular=self.webpackChunkangular||[]).push([[846],{7846:(z,_,s)=>{s.r(_),s.d(_,{AuthModule:()=>H});var f=s(89),l=s(6789),u=s(1300),i=s(6652),m=s(2369),p=s(2074),c=s(2151),d=s(9978),t=s(4355);let h=(()=>{class r{constructor(){this.auth=(0,t.f3M)(d.e),this.router=(0,t.f3M)(l.F0)}canActivate(){return!!this.auth.isLoggedIn()||(this.router.navigate(["/home/login"]),!1)}}return r.\u0275fac=function(o){return new(o||r)},r.\u0275prov=t.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})(),C=(()=>{class r{constructor(){this.auth=(0,t.f3M)(d.e),this.router=(0,t.f3M)(l.F0)}canActivate(){return!this.auth.isLoggedIn()||(this.router.navigate(["/home/profile"]),!1)}}return r.\u0275fac=function(o){return new(o||r)},r.\u0275prov=t.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var Z=s(3787),F=s(9676),T=s(3568),w=s(6738);function g(r){const n=[];return r.errors&&n.push(...Object.keys(r.errors).map(o=>r.getError(o))),n}function v(r,n){1&r&&(t.TgZ(0,"mat-error"),t._uU(1," Password is required "),t.qZA())}function y(r,n){if(1&r&&(t.TgZ(0,"mat-error"),t._uU(1),t.qZA()),2&r){const o=n.$implicit;t.xp6(1),t.hij(" ",o," ")}}function x(r,n){if(1&r){const o=t.EpF();t.TgZ(0,"mat-form-field",1)(1,"mat-label"),t._uU(2,"Password"),t.qZA(),t._UZ(3,"input",2),t.YNc(4,v,2,0,"mat-error",3),t.YNc(5,y,2,1,"mat-error",4),t.TgZ(6,"button",5),t.NdJ("click",function(){t.CHM(o);const a=t.oxw();return t.KtG(a.hidePassword=!a.hidePassword)}),t.TgZ(7,"mat-icon"),t._uU(8),t.qZA()()()}if(2&r){const o=n.ngIf,e=t.oxw();t.xp6(3),t.Q6J("formControl",o)("type",e.hidePassword?"password":"text"),t.xp6(1),t.Q6J("ngIf",o.hasError("required")),t.xp6(1),t.Q6J("ngForOf",e.getFieldErrors(o)),t.xp6(1),t.uIk("aria-label","Hide password")("aria-pressed",e.hidePassword),t.xp6(2),t.Oqu(e.hidePassword?"visibility_off":"visibility")}}let A=(()=>{class r{constructor(){this.hidePassword=!0,this.getFieldErrors=g,this.passwordControl=new i.NI}}return r.\u0275fac=function(o){return new(o||r)},r.\u0275cmp=t.Xpm({type:r,selectors:[["camp-password-field"]],inputs:{passwordControl:"passwordControl"},decls:1,vars:1,consts:[["class","form__field",4,"ngIf"],[1,"form__field"],["matInput","",3,"formControl","type"],[4,"ngIf"],[4,"ngFor","ngForOf"],["type","button","mat-icon-button","","matSuffix","",3,"click"]],template:function(o,e){1&o&&t.YNc(0,x,9,7,"mat-form-field",0),2&o&&t.Q6J("ngIf",e.passwordControl)},dependencies:[f.sg,f.O5,u.RK,i.Fj,i.JJ,i.oH,p.Nt,m.KE,m.hX,m.TO,m.R9,c.Hw],styles:[".form__field[_ngcontent-%COMP%]{display:grid}"]}),r})();function P(r,n){1&r&&(t.TgZ(0,"mat-error"),t._uU(1," Email is required "),t.qZA())}function I(r,n){if(1&r&&(t.TgZ(0,"mat-error"),t._uU(1),t.qZA()),2&r){const o=n.$implicit;t.xp6(1),t.hij(" ",o," ")}}function J(r,n){if(1&r&&(t.TgZ(0,"mat-form-field")(1,"mat-label"),t._uU(2,"Email:"),t.qZA(),t._UZ(3,"input",7),t.YNc(4,P,2,0,"mat-error",1),t.YNc(5,I,2,1,"mat-error",8),t.qZA()),2&r){const o=n.ngIf,e=t.oxw();t.xp6(3),t.Q6J("formControl",o),t.xp6(1),t.Q6J("ngIf",o.hasError("required")),t.xp6(1),t.Q6J("ngForOf",e.getFieldErrors(o))}}let E=(()=>{class r{constructor(){this.hidePasswordRetype=!0,this.authService=(0,t.f3M)(d.e),this.router=(0,t.f3M)(l.F0),this.formBuilder=(0,t.f3M)(i.j3),this.loginForm=this.formBuilder.group({email:["",i.kI.required],password:["",i.kI.required]},{updateOn:"submit"}),this.getFieldErrors=g}handleLoginError(o){return o instanceof w.UA&&o.error.errors.forEach(e=>{const a=this.loginForm.get(e.attr);a?a.setErrors({...a.errors??{},[e.code]:e.detail}):(this.loginForm.controls.email.setErrors({[e.code]:e.detail}),this.loginForm.controls.password.setErrors({[e.code]:e.detail}))}),(0,Z._)(()=>o)}onSubmit(){if(!1===this.loginForm.invalid){const o=this.loginForm.getRawValue();this.authService.login(o).pipe((0,F.P)(),(0,T.K)(e=>this.handleLoginError(e))).subscribe({next:()=>{this.router.navigate(["/home/profile"])},error(e){console.error("Error during registration",e)}})}}}return r.\u0275fac=function(o){return new(o||r)},r.\u0275cmp=t.Xpm({type:r,selectors:[["camp-login"]],decls:10,vars:3,consts:[[1,"form",3,"formGroup","ngSubmit"],[4,"ngIf"],[3,"passwordControl"],["mat-flat-button","","color","primary","type","submit"],[1,"navigation"],["routerLink","/home/registration","mat-raised-button",""],["routerLink","/anime","mat-raised-button",""],["matInput","",3,"formControl"],[4,"ngFor","ngForOf"]],template:function(o,e){1&o&&(t.TgZ(0,"form",0),t.NdJ("ngSubmit",function(){return e.onSubmit()}),t.YNc(1,J,6,3,"mat-form-field",1),t._UZ(2,"camp-password-field",2),t.TgZ(3,"button",3),t._uU(4,"Sign in"),t.qZA()(),t.TgZ(5,"nav",4)(6,"a",5),t._uU(7,"Sign up"),t.qZA(),t.TgZ(8,"a",6),t._uU(9,"Anime"),t.qZA()()),2&o&&(t.Q6J("formGroup",e.loginForm),t.xp6(1),t.Q6J("ngIf",e.loginForm.controls.email),t.xp6(1),t.Q6J("passwordControl",e.loginForm.controls.password))},dependencies:[f.sg,f.O5,l.rH,u.zs,u.lW,i._Y,i.Fj,i.JJ,i.JL,i.oH,i.sg,p.Nt,m.KE,m.hX,m.TO,A],styles:[".form[_ngcontent-%COMP%]{display:grid;padding:30px}.navigation[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);grid-column-gap:30px;padding:0 30px}"]}),r})();function b(r,n){1&r&&(t.TgZ(0,"mat-error"),t._uU(1," Email is required "),t.qZA())}function q(r,n){if(1&r&&(t.TgZ(0,"mat-error"),t._uU(1),t.qZA()),2&r){const o=n.$implicit;t.xp6(1),t.hij(" ",o," ")}}function R(r,n){if(1&r&&(t.TgZ(0,"mat-form-field")(1,"mat-label"),t._uU(2,"Email:"),t.qZA(),t._UZ(3,"input",7),t.YNc(4,b,2,0,"mat-error",1),t.YNc(5,q,2,1,"mat-error",8),t.qZA()),2&r){const o=n.ngIf,e=t.oxw();t.xp6(3),t.Q6J("formControl",o),t.xp6(1),t.Q6J("ngIf",o.hasError("required")),t.xp6(1),t.Q6J("ngForOf",e.getFieldErrors(o))}}function N(r,n){1&r&&(t.TgZ(0,"mat-error"),t._uU(1," First name is required "),t.qZA())}function M(r,n){if(1&r&&(t.TgZ(0,"mat-form-field")(1,"mat-label"),t._uU(2,"First name:"),t.qZA(),t._UZ(3,"input",9),t.YNc(4,N,2,0,"mat-error",1),t.qZA()),2&r){const o=n.ngIf;t.xp6(3),t.Q6J("formControl",o),t.xp6(1),t.Q6J("ngIf",o.hasError("required"))}}function Q(r,n){1&r&&(t.TgZ(0,"mat-error"),t._uU(1," Last name is required "),t.qZA())}function L(r,n){if(1&r&&(t.TgZ(0,"mat-form-field")(1,"mat-label"),t._uU(2,"Last name:"),t.qZA(),t._UZ(3,"input",9),t.YNc(4,Q,2,0,"mat-error",1),t.qZA()),2&r){const o=n.ngIf;t.xp6(3),t.Q6J("formControl",o),t.xp6(1),t.Q6J("ngIf",o.hasError("required"))}}function S(r,n){1&r&&(t.TgZ(0,"mat-error"),t._uU(1," Repeat password "),t.qZA())}function Y(r,n){1&r&&(t.TgZ(0,"mat-error"),t._uU(1," Passwords do not match "),t.qZA())}function k(r,n){if(1&r){const o=t.EpF();t.TgZ(0,"mat-form-field")(1,"mat-label"),t._uU(2,"Repeat Password"),t.qZA(),t._UZ(3,"input",10),t.YNc(4,S,2,0,"mat-error",1),t.YNc(5,Y,2,0,"mat-error",1),t.TgZ(6,"button",11),t.NdJ("click",function(){t.CHM(o);const a=t.oxw();return t.KtG(a.hidePasswordRetype=!a.hidePasswordRetype)}),t.TgZ(7,"mat-icon"),t._uU(8),t.qZA()()()}if(2&r){const o=n.ngIf,e=t.oxw();t.xp6(3),t.Q6J("formControl",o)("type",e.hidePasswordRetype?"password":"text"),t.xp6(1),t.Q6J("ngIf",o.hasError("required")),t.xp6(1),t.Q6J("ngIf",o.hasError("matching")),t.xp6(1),t.uIk("aria-label","Hide password")("aria-pressed",e.hidePasswordRetype),t.xp6(2),t.Oqu(e.hidePasswordRetype?"visibility_off":"visibility")}}const O=[{path:"profile",component:(()=>{class r{constructor(){this.authService=(0,t.f3M)(d.e),this.router=(0,t.f3M)(l.F0)}logout(){this.authService.logout(),this.router.navigate(["/anime/table"])}}return r.\u0275fac=function(o){return new(o||r)},r.\u0275cmp=t.Xpm({type:r,selectors:[["camp-profile"]],decls:7,vars:0,consts:[[1,"profile"],["type","button","mat-raised-button","","color","primary",3,"click"],["routerLink","/anime","mat-raised-button",""]],template:function(o,e){1&o&&(t.TgZ(0,"div",0)(1,"h1"),t._uU(2,"Welcome to your profile!"),t.qZA(),t.TgZ(3,"button",1),t.NdJ("click",function(){return e.logout()}),t._uU(4,"Log out"),t.qZA(),t.TgZ(5,"a",2),t._uU(6,"Table"),t.qZA()())},dependencies:[l.rH,u.zs,u.lW],styles:[".profile[_ngcontent-%COMP%]{display:grid;grid-row-gap:30px;text-align:center}"]}),r})(),canActivate:[h]},{path:"login",component:E,canActivate:[C]},{path:"registration",component:(()=>{class r{constructor(){this.hidePasswordRetype=!0,this.authService=(0,t.f3M)(d.e),this.router=(0,t.f3M)(l.F0),this.formBuilder=(0,t.f3M)(i.j3),this.registrationForm=this.formBuilder.group({email:["",i.kI.required],firstName:["",i.kI.required],lastName:["",i.kI.required],password:["",i.kI.required],confirmPassword:["",[i.kI.required,r=>r.value===r.parent?.get("password")?.value?null:{matching:!0}]]},{updateOn:"submit"}),this.getFieldErrors=g}handleRegistrationError(o){return o instanceof w.UA&&o.error.errors.forEach(e=>{const a=this.registrationForm.get(e.attr);a&&a.setErrors({...a.errors??{},[e.code]:e.detail})}),(0,Z._)(()=>o)}onSubmit(){if(!1===this.registrationForm.invalid){const o=this.registrationForm.getRawValue();this.authService.register(o).pipe((0,F.P)(),(0,T.K)(e=>this.handleRegistrationError(e))).subscribe({next:()=>{this.router.navigate(["/home/profile"])},error(e){console.error("Error during registration",e)}})}}}return r.\u0275fac=function(o){return new(o||r)},r.\u0275cmp=t.Xpm({type:r,selectors:[["camp-registration"]],decls:13,vars:6,consts:[[1,"form",3,"formGroup","ngSubmit"],[4,"ngIf"],[3,"passwordControl"],["mat-flat-button","","color","primary","type","submit"],[1,"navigation"],["routerLink","/home/login","mat-raised-button",""],["routerLink","/anime","mat-raised-button",""],["matInput","","formControlName","email",3,"formControl"],[4,"ngFor","ngForOf"],["matInput","",3,"formControl"],["matInput","",3,"formControl","type"],["type","button","mat-icon-button","","matSuffix","",3,"click"]],template:function(o,e){1&o&&(t.TgZ(0,"form",0),t.NdJ("ngSubmit",function(){return e.onSubmit()}),t.YNc(1,R,6,3,"mat-form-field",1),t.YNc(2,M,5,2,"mat-form-field",1),t.YNc(3,L,5,2,"mat-form-field",1),t._UZ(4,"camp-password-field",2),t.YNc(5,k,9,7,"mat-form-field",1),t.TgZ(6,"button",3),t._uU(7,"Sign up"),t.qZA()(),t.TgZ(8,"nav",4)(9,"a",5),t._uU(10,"Sign in"),t.qZA(),t.TgZ(11,"a",6),t._uU(12,"Anime"),t.qZA()()),2&o&&(t.Q6J("formGroup",e.registrationForm),t.xp6(1),t.Q6J("ngIf",e.registrationForm.controls.email),t.xp6(1),t.Q6J("ngIf",e.registrationForm.controls.firstName),t.xp6(1),t.Q6J("ngIf",e.registrationForm.controls.lastName),t.xp6(1),t.Q6J("passwordControl",e.registrationForm.controls.password),t.xp6(1),t.Q6J("ngIf",e.registrationForm.controls.confirmPassword))},dependencies:[f.sg,f.O5,l.rH,u.zs,u.lW,u.RK,i._Y,i.Fj,i.JJ,i.JL,i.oH,i.sg,i.u,p.Nt,m.KE,m.hX,m.TO,m.R9,c.Hw,A],styles:[".form[_ngcontent-%COMP%]{display:grid;padding:30px}.navigation[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);grid-column-gap:30px;padding:0 30px}"]}),r})(),canActivate:[C]},{path:"",redirectTo:"profile",pathMatch:"full"}];let G=(()=>{class r{}return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[l.Bz.forChild(O),l.Bz]}),r})(),H=(()=>{class r{}return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({providers:[d.e,h],imports:[f.ez,G,l.Bz,u.ot,i.u5,i.UX,p.c,m.lN,c.Ps]}),r})()}}]);